# IPython log file

seq = "TTCATTATAAATCTAGAGACTCCAGGATTTTAACGTTCTGCTGGACTGAGCTGGTTGCCTCATGTTATTATGCAGGCAACTCACTTTATCCCAATTTCTTGATACTTTTCCTTCTGGAGGTCCTATTTCTCTAACATCTTCCAGAAAAGTCTTAAAGCTGCCTTAACCTTTTTTCCAGTCCACCTCTTAAATTTTTTCCTCCTCTTCCTCTATACTAACATGAGTGTGGATCCAGCTTGTCCCCAAAGCTTGCCTTGCTTTGAAGCATCCGACTGTAAAGAATCTTCACCTATGCCTGTGATTTGTGGGCCTGAAGAAAACTATCCATCCTTGCAAATGTCTTCTGCTGAGATGCCTCACACGGAGACTGTCTCTCCTCTTCCTTCCTCCATGGATCTGCTTATTCAGGACAGCCCTGATTCTTCCACCAGTCCCAAAGGCAAACAACCCACTTCTGCAGAGAAGAGTGTCGCAAAAAAGGAAGACAAGGTCCCGGTCAAGAAACAGAAGACCAGAACTGTGTTCTCTTCCACCCAGCTGTGTGTACTCAATGATAGATTTCAGAGACAGAAATACCTCAGCCTCCAGCAGATGCAAGAACTCTCCAACATCCTGAACCTCAGCTACAAACAGGTGAAGACCTGGTTCCAGAACCAGAGAATGAAATCTAAGAGGTGGCAGAAAAACAACTGGCCGAAGAATAGCAATGGTGTGACGCAGGGATGCCTGGTGAACCCGACTGGGAACCTTCCAATGTGGAGCAACCAGACCTGGAACAATTCAACCTGGAGCAACCAGACCCAGAACATCCAGTCCTGGAGCAACCACTCCTGGAACACTCAGACCTGGTGCACCCAATCCTGGAACAATCAGGCCTGGAACAGTCCCTTCTATAACTGTGGAGAGGAATCTCTGCAGTCCTGCATGCAGTTCCAGCCAAATTCTCCTGCCAGTGACTTGGAGGCTGCCTTGGAAGCTGCTGGGGAAGGCCTTAATGTAATACAGCAGACCACTAGGTATTTTAGTACTCCACAAACCATGGATTTATTCCTAAACTACTCCATGAACATGCAACCTGAAGACGTGTGAAGATGAGTGAAACTGATATTACTCAATTTCAGTCTGGACACTGGCTGAATCCTTCCTCTCCCCTCCTCCCATCCCTCATAGGATTTTTCTTGTTTGGAAACCACGTGTTCTGGTTTCCATGATGCCCATCCAGTCAATCTCATGGAGGGTGGAGTATGGTTGGAGCCTAATCAGCGAGGTTTCTTTTTTTTTTTTTTTCCTATTGGATCTTCCTGGAGAAAATACTTTTTTTTTTTTTTTTTTTGAAACGGAGTCTTGCTCTGTCGCCCAGGCTGGAGTGCAGTGGCGCGGTCTTGGCTCACTGCAAGCTCCGTCTCCCGGGTTCACGCCATTCTCCTGCCTCAGCCTCCCGAGCAGCTGGGACTACAGGCGCCCGCCACCTCGCCCGGCTAATATTTTGTATTTTTAGTAGAGACGGGGTTTCACTGTGTTAGCCAGGATGGTCTCGATCTCCTGACCTTGTGATCCACCCGCCTCGGCCTCCCTAACAGCTGGGATTTACAGGCGTGAGCCACCGCGCCCTGCCTAGAAAAGACATTTTAATAACCTTGGCTGCCGTCTCTGGCTATAGATAAGTAGATCTAATACTAGTTTGGATATCTTTAGGGTTTAGAATCTAACCTCAAGAATAAGAAATACAAGTACAAATTGGTGATGAAGATGTATTCGTATTGTTTGGGATTGGGAGGCTTTGCTTATTTTTTAAAAACTATTGAGGTAAAGGGTTAAGCTGTAACATACTTAATTGATTTCTTACCGTTTTTGGCTCTGTTTTGCTATATCCCCTAATTTGTTGGTTGTGCTAATCTTTGTAGAAAGAGGTCTCGTATTTGCTGCATCGTAATGACATGAGTACTGCTTTAGTTGGTTTAAGTTCAAATGAATGAAACAACTATTTTTCCTTTAGTTGATTTTACCCTGATTTCACCGAGTGTTTCAATGAGTAAATATACAGCTTAAACATAA"
import re
re.findall('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq)
a='ATGAGTGTGGATCCAGCTTGTCCCCAAAGCTTGCCTTGCTTTGAAGCATCCGACTGTAAAGAATCTTCACCTATGCCTGTGATTTGTGGGCCTGAAGAAAACTATCCATCCTTGCAAATGTCTTCTGCTGAGATGCCTCACACGGAGACTGTCTCTCCTCTTCCTTCCTCCATGGATCTGCTTATTCAGGACAGCCCTGATTCTTCCACCAGTCCCAAAGGCAAACAACCCACTTCTGCAGAGAAGAGTGTCGCAAAAAAGGAAGACAAGGTCCCGGTCAAGAAACAGAAGACCAGAACTGTGTTCTCTTCCACCCAGCTGTGTGTACTCAATGATAGATTTCAGAGACAGAAATACCTCAGCCTCCAGCAGATGCAAGAACTCTCCAACATCCTGAACCTCAGCTACAAACAGGTGAAGACCTGGTTCCAGAACCAGAGAATGAAATCTAAGAGGTGGCAGAAAAACAACTGGCCGAAGAATAGCAATGGTGTGACGCAGGGATGCCTGGTGAACCCGACTGGGAACCTTCCAATGTGGAGCAACCAGACCTGGAACAATTCAACCTGGAGCAACCAGACCCAGAACATCCAGTCCTGGAGCAACCACTCCTGGAACACTCAGACCTGGTGCACCCAATCCTGGAACAATCAGGCCTGGAACAGTCCCTTCTATAACTGTGGAGAGGAATCTCTGCAGTCCTGCATGCAGTTCCAGCCAAATTCTCCTGCCAGTGACTTGGAGGCTGCCTTGGAAGCTGCTGGGGAAGGCCTTAATGTAATACAGCAGACCACTAGGTATTTTAGTACTCCACAAACCATGGATTTATTCCTAAACTACTCCATGAACATGCAACCTGAAGACGTGTGA'
len(a)
b='ATGAGTGTGGATCCAGCTTGTCCCCAAAGCTTGCCTTGCTTTGAAGCATCCGACTGTAAAGAATCTTCACCTATGCCTGTGATTTGTGGGCCTGAAGAAAACTATCCATCCTTGCAAATGTCTTCTGCTGAGATGCCTCACACGGAGACTGTCTCTCCTCTTCCTTCCTCCATGGATCTGCTTATTCAGGACAGCCCTGATTCTTCCACCAGTCCCAAAGGCAAACAACCCACTTCTGCAGAGAAGAGTGTCGCAAAAAAGGAAGACAAGGTCCCGGTCAAGAAACAGAAGACCAGAACTGTGTTCTCTTCCACCCAGCTGTGTGTACTCAATGATAGATTTCAGAGACAGAAATACCTCAGCCTCCAGCAGATGCAAGAACTCTCCAACATCCTGAACCTCAGCTACAAACAGGTGAAGACCTGGTTCCAGAACCAGAGAATGAAATCTAAGAGGTGGCAGAAAAACAACTGGCCGAAGAATAGCAATGGTGTGACGCAGGGATGCCTGGTGAACCCGACTGGGAACCTTCCAATGTGGAGCAACCAGACCTGGAACAATTCAACCTGGAGCAACCAGACCCAGAACATCCAGTCCTGGAGCAACCACTCCTGGAACACTCAGACCTGGTGCACCCAATCCTGGAACAATCAGGCCTGGAACAGTCCCTTCTATAACTGTGGAGAGGAATCTCTGCAGTCCTGCATGCAGTTCCAGCCAAATTCTCCTGCCAGTGACTTGGAGGCTGCCTTGGAAGCTGCTGGGGAAGGCCTTAATGTAATACAGCAGACCACTAGGTATTTTAGTACTCCACAAACCATGGATTTATTCCTAAACTACTCCATGAACATGCAACCTGAAGACGTGTGA'
len(b)
ATGs=[i.span() for i in re.finditer('(ATG)',seq)]
a=re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq)
a.next().group()
a
a.next()
for i in a:
    i.span()
    
ATGs=[i.span() for i in re.finditer('(ATG)',seq)]
ATGs
len(ATGs)
ORFs=[]
for i in ATGs:
    start=i[0]
    end=i[1]
    while(end < len(seq)):
        if seq[end:(end+3)] == "TGA" or seq[end:(end+3)] == "TAA" or seq[end:(end+3)] == "TAG":
            end+=3
            ORFs.append((seq[start:end],end-start,[start,end]))
            end=len(seq)
        else:
            end+=3
            
ORFs
len(ORFs)
re.findall('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq)
re.findall('(ATG([TACG]{3})+?(TAA|TAG|TGA))','ATGCCCATCCAGTCAATCTCATGGAGGGTGGAGTATGGTTGGAGCCTAATCAGCGAGGTTTCTTTTTTTTTTTTTTTCCTATTGGATCTTCCTGGAGAAAATACTTTTTTTTTTTTTTTTTTTGAAACGGAGTCTTGCTCTGTCGCCCAGGCTGGAGTGCAGTGGCGCGGTCTTGGCTCACTGCAAGCTCCGTCTCCCGGGTTCACGCCATTCTCCTGCCTCAGCCTCCCGAGCAGCTGGGACTACAGGCGCCCGCCACCTCGCCCGGCTAATATTTTGTATTTTTAG')
for i in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq):
    print(i.span())
    
ATGs
orfs = []
for i in ATGs:    re.findall('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])
for i in ATGs:
    orfs+=[(o.span(),o.group()) for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])]
    
        
orfs
len(orfs)
for i in ATGs:
    orfs+=([(o.span(),o.group()) for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])][0])
    
    
        
orfs = []
for i in ATGs:
    orfs+=([(o.span(),o.group()) for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])][0])
    
    
        
orfs
len(ORFs)
len(orfs)
ORFs
for i in ATGs:
    orfs+=([o.group() for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])][0])
    
    
    
        
orfs=[]
for i in ATGs:
    orfs+=([o.group() for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])][0])
    
    
    
        
orfs
for i in ATGs:
    orfs+=([o.group() for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])][0])
    
orfs = []
orfs
for i in ATGs:
    orfs+=([o.group() for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])])
    
    
orfs[0]
for i in ATGs:
    orfs+=([o.group() for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])][0])
       
orfs[0]
len(orfs)
orfs[1]
for i in ATGs:
    orfs+=([(o.span(),o.group()) for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])][0])
    
    
        
orfs=[]
for i in ATGs:
    orfs+=([(o.span(),o.group()) for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])][0])
    
    
        
orfs
for i in ATGs:
    orfs+=([(o.group()) for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])][0])        
    
orfs = []
for i in ATGs:
    orfs+=([(o.group()) for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])][0])        
    
orfs
for i in ATGs:
    seqlist = [o.group() for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])]
    print(seqlist)
    orfs+=seqlist[0]
    
   
orfs = []
for i in ATGs:
    seqlist = [o.group() for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])]
    print(seqlist)
    orfs+=seqlist[0]
    
   
orfs
for i in ATGs:
    seqlist = [o.group() for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])]
    print(seqlist)
    print(seqlist[0])
    orfs+=seqlist[0]
    
   
for i in ATGs:
    seqlist = [o.group() for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])]
#    print(seqlist)
    print(seqlist[0])
    orfs+=seqlist[0]
    
   
for i in ATGs:
    seqlist = [o.group() for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])]
#    print(seqlist)
    print(seqlist[0])
    orfs+=[seqlist[0]]
    
    
   
orfs = []
for i in ATGs:
    seqlist = [o.group() for o in re.finditer('(ATG([TACG]{3})+?(TAA|TAG|TGA))',seq[i[0]:])]
#    print(seqlist)
    print(seqlist[0])
    orfs+=[seqlist[0]]
    
    
   
orfs
len(orfs)
get_ipython().run_line_magic('ls', '')
get_ipython().run_line_magic('logstart', 'MaxLenORF_re_version.py')
get_ipython().run_line_magic('logoff', '')
